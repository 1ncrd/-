# CTF SR 23.05.24 - Incrd

## LLL 解决背包问题

<https://blog.csdn.net/qq_51999772/article/details/126795199#commentBox>

<https://blog.csdn.net/cccchhhh6819/article/details/130405012#t4>

## 2023数字中国创新大赛网络数据安全赛道决赛 easybag

穷举 sum = c + i * p，用 LLL 解背包问题。

```py
p = 94154607166206368507849450076562888867777996786776585204541315115554265673239
pubkey = [13558005804894620335697666695157375129697290797741397021993594548263141225185, 59100377682228233248259149993117848589507966669415965396505753313255772484735, 47203140847285209690197775939725446140228935533192678649736832535977586766657, 41931934930013700538175901034615026851307155264693289541912768198101883139200, 34600830342506187749361900452651328134776307385652325752852473167695972843115, 87640782336847365756484674868883213823373923714943730733375997668462983688038, 46665325617149847662294815433566827879247054902007756459977900724576956930238, 7630102294629000071648786320570215400445944873898703154806156572372671923081, 28527795592041096912997042180130633828658042409636021884128608005311625241616, 48817875040757505575226334137591514796302781418971911589454396062223787201917, 13255147124279970300070471647577356621503689887387302226734806820266747474808, 35402792535703359866981648503422240071754439627501334894850939689231868215135, 32096486738038490474299531943010354951480863898639806169937034178619974350617, 53796403150739214931374312544531149937237602632833613136878306939750970956473, 54983553100507197181500293731582654525408296950106771274995347122732790613144, 78089465497793663917498756488988307210150642639541862861838679893054295887504, 72102666461042750236884036568516037906284283594884004107747986408795866699372, 25205929877393680775925192899276583872943822522732792361803075959348555266633, 73569982812592191070543881751396722110823057810338019363134145063958506216983, 2088202935774439157687167818481322834944309182788412111799843369630242323474, 48595322641271785006228649310883337480428294554328113174151951016612527760846, 51760926243228584037653924308259980640851259284678368807891664272274451903042, 60972672839459660624733547945444352444564866386661657085629482140478629017252, 81764834201781756833426691130605289192895677482907294866198302409014283345719, 45564921427256648952930549595744780922450728606081883043890551086293741648704, 11546124315022121112010407507682750282699601646772973993144675005994676860886, 92131518253108261083785500706056401679992613109559776512718290127164091431412, 51389379720849274237033447110263198191452790814489779714421318664581053598808, 44312622653933798618054908129398899008892235276397257672730716870062818221473, 70666271772579353628875975929849785989895352053744867444867924961771176550910, 1022761764417929351401227837288503469803327306746617444127801609783349439735, 68627432450132640523862810752994895413427816006228852597818417524517732514350, 8511138383146897962027474703813126003023440135100045398587391499968626350422, 31835105391545548957341476664214356089634342776763639131243986103325636836303, 55948480159418323822671978119946237891780186582911116704975552528012107246904, 55939548765231641770843516606677961462192677789127144112398249578595518236030, 20278834290551726759933704289080539150033014812784593972020141194417541880439, 73338740361159581768576605670854710647315802795532659722801776055886181249196, 76030530797619429775272782139815361420031920989903555900304383499427424691028, 29434488504120326762494784919047205002020356219284552062468984751289660011144, 70227628106756168643766787327064214794880142284692886739392137490279018434102, 24574946221293978596894258842130084362477010338545022538797491453437090815299, 6498106168053907890618186261665652189349047912867389234926938720401618310435, 89544437087791083328953917039272623964595858289587652369164257989512245819862, 10160703116362866249140930173762313868253569896922018161770610214791827114729, 76227093331364018857371734525542577074111530213433351474717923617789017495624, 15711426473810618056409128995696582093601485048202406838767589077201299123260, 10686228588336791778046934061860194190302510165978184916374294528370290854376, 743613502117417805717788796940788273702216571188502886117674965400126386594, 78117535452041628513083051136496582640102481347370178358531807794866005852302, 65422888907790441789066675735260369825243738808162289359370573767294073389543, 64513441837802159954407971302165651403055502196511115018903417756542405033208, 1445954148502126112702617051436662059642285218246554311110203671284796568239, 78441138130637968035058014810800340697720095799909152986595764312261055325612, 72602744597138181431124073095992777463769309366668520177727154848781655032600, 9786934211176167525996495418302215387385800641019822009416705683093970268940, 44943695239822266941127148357724393787078734075722008436487144680302609249634, 70781641195178108826300599782282991675945297046163684928015312469855982285294, 58235271417245212032570174014807598168239520942582767758692549437338153222204, 92877022115452578515908587738974006957886472693342404193199518045790086717455, 70767591165382026255868033108388660762134896305917797432131257129495704309297, 55657364531211200525510486301527531771575735049596151759833888509362181870297, 44336153977928031254990878584737529363699845706938343159951700205026319387000, 68798336155332657027923387549177788534756411943373654774711482160905197111316]
c = 300528310281431128814608316680537971945579270793936168485054801251195415271
enc = b'Z\x8b `I\xa6\xde\nF\x13J\xf4^1}\x98*R-[\x9c\x851\xf4\xeeF\xea\xbc$s\xd8\xb4F\xebg\x86\x8e\xb0\xc9%V\x12&Rw\xcc\n\xc0'

m = [[0 for _ in range(65)] for _ in range(65)]
for i in range(64):
    m[i][-1] = pubkey[i]
    m[i][i] = 1

for i in range(10, 30):
    print(i, end=" ")
    m[-1][-1] = -(c + i * p)
    M = Matrix(m)
    M = M.LLL()
    if all(int(e) in (0, 1) for e in list(M)[0]):
        key = "".join([str(_) for _ in list(M)[0][:-1]])
        print(key)
        break
```

```txt
10 11 12 13 14 0100010111000111011000000001010111000000110100100011100110001011
```

```py
from Crypto.Cipher import AES
from Crypto.Util.number import long_to_bytes
key = long_to_bytes(int(key, 2))
aes = AES.new(key=key * 2, mode=AES.MODE_ECB)
enc = aes.decrypt(enc)
print(enc)
```

```txt
b'flag{e42f0ab28e1c5fb04bbb0c797a2cd951}\n\n\n\n\n\n\n\n\n\n'
```
